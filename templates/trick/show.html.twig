{% extends 'base.html.twig' %}

{% block title %}{{ trick.title }}{% endblock %}

{% block body %}
    <div class="trick-page" data-trick="{{ trick.id }}" id="trick-page">
        <div class="row justify-content-center margin-bottom margin-top">
            <a href="{{ path('home') }}" class="btn btn-info col-md-2"> Retour </a>
            <div class="col-md-6"></div>
        </div>
        <div class="img-presentation justify-content-center row">
            <img src="/assets/images/{{ trick.imageName }}" class="col-8">
        </div>
        <div class="row justify-content-center">
            <h1 class="col-7">{{ trick.title }}</h1>
            <div class="col-1 row">
                <a href="{{ path('trick_edit', {'slug': trick.slug}) }}" class="col-2"><img src="/assets/images/logo-edit.png" alt="modifier"></a>
                <a class="col-2">{{ include('trick/_delete_form.html.twig') }}</a>
            </div>
        </div>
        <div class="row justify-content-center">
            <p class="col-8">{{ trick.chapo }}</p>
        </div>
        {% if (images) or (videos) %}
            <div class="medias row justify-content-center d-none d-sm-flex">
                <div class="photos col-lg-4 col-md-8">
                    <div id="carousel" class="carousel slide" data-ride="carousel">
                        <div class="carousel-inner">
                            {% for image in images %}
                                <div class="carousel-item {% if loop.index0 == 0 %} active {% endif %}">
                                    <img src="/assets/images/{{ image.name }}">
                                </div>
                            {% endfor %}
                        </div>
                        <a class="carousel-control-prev" href="#carousel" role="button" data-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carousel" role="button" data-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
                <div class="videos col-lg-4 col-md-8">
                    <div id="carousel-videos" class="carousel slide" data-ride="carousel">
                        <div class="carousel-inner">
                            {% for video in videos %}
                                <div class="carousel-item {% if loop.index0 == 0 %} active {% endif %}">
                                    <iframe src="{{ video.url }}" frameborder="0" allowfullscreen></iframe>
                                </div>
                            {% endfor %}
                        </div>
                        <a class="carousel-control-prev" href="#carousel-videos" role="button" data-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carousel-videos" role="button" data-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
            </div>
            <div class="text-center">
                <a href="#" id="loadMedia" class="d-md-block d-lg-none">
                    <button class="btn btn-info">Afficher les médias</button>
                </a>
                <a href="#" id="hideMedia" class="d-none d-md-none d-lg-none">
                    <button class="btn btn-info">Masquer les médias</button>
                </a>
            </div>
        {% else %}
            <div class="row text-center justify-content-center">
                <p class="col-8"> Pas de média pour ce trick</p>
            </div>
        {% endif %}
        <div class="row justify-content-center text-center">
            <p class="col-8">{{ trick.content }}</p>
        </div>
        <div class="row justify-content-center">
            <p class="col-2"> Créé le : {{ trick.createdAt ? trick.createdAt|date('Y-m-d H:i:s') : '' }}</p>
            <p class="col-2"> Mis à jour le : {{ trick.updatedAt ? trick.updatedAt|date('Y-m-d H:i:s') : '' }} </p>
            <p class="col-2"> Créé par : {{ trick.user }} </p>
        </div>
        {% if app.user %}
            <div class="form-comment">
                <div class="row justify-content-center">
                    <h3 class="col-8">Bonjour {{ app.user.firstname }}</h3>
                </div>
                <div class="row justify-content-center">
                    {{ form_start(form) }}
                    <div class="col-4">
                        {{ form_row(form.comment) }}
                    </div>
                    <div class="col-4">
                        <button type="submit" class="btn btn-info"> Commenter </button>
                    </div>
                    {{ form_end(form) }}
                </div>
            </div>
        {% else %}
            <div class="row justify-content-center">
                <p class="col-8"> Connectez-vous pour écrire un commentaire</p>
                <a class="btn btn-info col-8" href="{{ path('login') }}"> Se connecter</a>
            </div>
        {% endif %}
        <div class="comments row justify-content-center" id="comments">
            {% for comment in comments %}
                <div class="col-8">
                    <div>
                        <img src="/assets/images/{{ comment.user.avatar }}">
                        <p>{{ comment.user.firstname }} {{ comment.user.lastname }}</p>
                        <p> posté le : {{ comment.commentedAt | date('d/m/Y') }} à {{ comment.commentedAt | date('H:i') }} </p>
                    </div>
                    <div>
                        <p>{{ comment.comment }}</p>
                    </div>
                </div>
            {% endfor %}
        </div>
        <div class="row justify-content-center">
            <a class="btn btn-success loadComments col-3" id="loadComments" href="">Load More</a>
        </div>
    </div>
{% endblock %}
